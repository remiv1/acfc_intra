<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test QR Code pour Bon de Commande</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-container {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .qr-demo {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .qr-code {
            border: 1px solid #ccc;
        }
        .url-info {
            font-family: monospace;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Test du Syst√®me de Bon de Commande</h1>
    
    <div class="test-container">
        <h2>üéØ Am√©liorations Impl√©ment√©es</h2>
        <ul>
            <li>‚úÖ <strong>QR Code g√©n√©r√© c√¥t√© serveur</strong> avec la biblioth√®que Python qrcode</li>
            <li>‚úÖ <strong>Police plus claire (#333)</strong> pour √©conomiser le toner</li>
            <li>‚úÖ <strong>Tableau ultra-compact</strong> avec police 8pt et padding r√©duits</li>
            <li>‚úÖ <strong>En-t√™tes de colonnes raccourcies</strong> : "R√©f.", "P.U.", "Rem."</li>
            <li>‚úÖ <strong>Marges r√©duites</strong> de 15mm √† 12mm</li>
            <li>‚úÖ <strong>Espacement optimis√©</strong> pour maximiser l'espace disponible</li>
            <li>‚úÖ <strong>QR Code plus petit</strong> (60x60px) pour √©conomiser l'espace</li>
            <li>‚úÖ <strong>Remise affich√©e sans d√©cimale</strong> pour gagner de la place</li>
        </ul>
    </div>

    <div class="test-container">
        <h2>üñ®Ô∏è Exemple de QR Code</h2>
        <p>Voici un exemple de QR Code comme celui g√©n√©r√© sur le bon de commande :</p>
        <div class="qr-demo">
            <canvas id="exampleQR" width="100" height="100" class="qr-code"></canvas>
            <div>
                <div class="url-info" id="exampleUrl"></div>
                <p><em>Ce QR code contiendrait l'URL vers la commande sp√©cifique</em></p>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>üìã Structure du Bon de Commande</h2>
        <div style="border: 2px solid #333; padding: 15px; background: #fafafa;">
            <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #666; padding-bottom: 8px; margin-bottom: 15px;">
                <div style="font-size: 20pt; font-weight: bold; color: #333;">BON DE COMMANDE</div>
                <div style="font-size: 9pt; text-align: right; color: #666;">
                    Date de commande<br>
                    <strong>28/08/2025</strong>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                <div>
                    <div style="font-size: 16pt; font-weight: bold; color: #333;">N¬∞ 12345</div>
                    <div style="font-weight: bold; color: #333;">Client Exemple SARL</div>
                    <div style="color: #666; font-size: 9pt;">Description de la commande</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 14pt; font-weight: bold; color: #333;">1 234,56 ‚Ç¨</div>
                    <div style="color: #666; font-size: 9pt;">3 articles</div>
                </div>
            </div>
            
            <div style="border: 1px solid #ccc; padding: 8px; margin-bottom: 15px;">
                <strong style="color: #333; font-size: 12pt;">Articles command√©s</strong>
                <table style="width: 100%; font-size: 8pt; margin-top: 8px; border-collapse: collapse;">
                    <tr style="background: #f8f8f8;">
                        <th style="text-align: left; padding: 4px 6px; border: 1px solid #ccc; color: #333;">R√©f.</th>
                        <th style="text-align: left; padding: 4px 6px; border: 1px solid #ccc; color: #333;">D√©signation</th>
                        <th style="text-align: center; padding: 4px 6px; border: 1px solid #ccc; color: #333;">Qt√©</th>
                        <th style="text-align: right; padding: 4px 6px; border: 1px solid #ccc; color: #333;">P.U.</th>
                        <th style="text-align: center; padding: 4px 6px; border: 1px solid #ccc; color: #333;">Rem.</th>
                        <th style="text-align: right; padding: 4px 6px; border: 1px solid #ccc; color: #333;">Total</th>
                    </tr>
                    <tr>
                        <td style="padding: 3px 6px; font-family: monospace; border: 1px solid #ddd; font-size: 7pt; color: #333;"><strong>REF001</strong></td>
                        <td style="padding: 3px 6px; border: 1px solid #ddd; color: #333;">Produit exemple avec nom tr√®s long pour tester</td>
                        <td style="padding: 3px 6px; text-align: center; border: 1px solid #ddd; color: #333;">2</td>
                        <td style="padding: 3px 6px; text-align: right; border: 1px solid #ddd; color: #333;">500,00 ‚Ç¨</td>
                        <td style="padding: 3px 6px; text-align: center; border: 1px solid #ddd; color: #333;">5%</td>
                        <td style="padding: 3px 6px; text-align: right; border: 1px solid #ddd; color: #333;"><strong>950,00 ‚Ç¨</strong></td>
                    </tr>
                    <tr style="background: #f8f8f8; border-top: 2px solid #333;">
                        <td colspan="5" style="text-align: right; font-weight: bold; font-size: 10pt; padding: 4px 6px; color: #333;">TOTAL COMMANDE :</td>
                        <td style="text-align: right; font-weight: bold; font-size: 10pt; padding: 4px 6px; color: #333;">1 234,56 ‚Ç¨</td>
                    </tr>
                </table>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                <div>
                    <div style="border: 1px solid #ccc; width: 60px; height: 60px; background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZjVmNWY1IiBzdHJva2U9IiNjY2MiLz4KPHR0ZXh0IHg9IjMwIiB5PSIzNSIgZm9udC1zaXplPSI4IiBmaWxsPSIjNjY2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5RUiBDb2RlPC90ZXh0Pgo8L3N2Zz4K'); background-size: cover;"></div>
                    <div style="font-size: 7pt; color: #666; margin-top: 4px; max-width: 180px;">URL de la commande (plus petite)</div>
                </div>
                <div style="text-align: right; font-size: 8pt; color: #666;">
                    <div>G√©n√©r√© le 28/08/2025</div>
                    <div>ACFC - Syst√®me de gestion</div>
                </div>
            </div>
        </div>
    </div>

    <div class="test-container">
        <h2>üîß Instructions d'utilisation</h2>
        <ol>
            <li><strong>Acc√®s au bon :</strong> Dans les d√©tails d'une commande, cliquez sur le bouton "Bon de commande"</li>
            <li><strong>Impression :</strong> La page s'ouvre dans un nouvel onglet, optimis√©e pour l'impression</li>
            <li><strong>QR Code :</strong> Scannez le QR code pour acc√©der directement √† la commande</li>
            <li><strong>Format :</strong> Imprimez en format paysage pour un r√©sultat optimal</li>
        </ol>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // G√©n√©rer un exemple de QR code
            const exampleUrl = 'http://localhost:5000/commandes/client/123/commandes/456/details';
            document.getElementById('exampleUrl').textContent = exampleUrl;
            
            const canvas = document.getElementById('exampleQR');
            QRCode.toCanvas(canvas, exampleUrl, {
                width: 100,
                height: 100,
                margin: 1,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function (error) {
                if (error) {
                    console.error('Erreur QR Code:', error);
                }
            });
        });
    </script>
</body>
</html>
